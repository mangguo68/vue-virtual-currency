<template>
  <el-container>
    <!-- å¤´éƒ¨ -->
    <el-header class="!h-fit header-content">
      <HeaderFirstRow />
      <!-- ç¬¬äºŒè¡Œå†…å®¹ï¼šè´§å¸åˆ—è¡¨ -->
      <CurrencyList />
    </el-header>
    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <el-main>
      <!-- æ”¶ç›Šæ¨¡å—å®¹å™¨ - ä½¿ç”¨el-rowå’Œel-colå¸ƒå±€ -->
      <el-row>
        <!-- ç¬¬ä¸€è¡Œï¼šæ”¶ç›Šè¡¨ç°å’Œæ”¶ç›Šåˆ†è§£ -->
        <el-col class="p-3" :xs="24" :sm="24" :md="24" :lg="16" :xl="16">
          <PerformanceChart />
        </el-col>
        <el-col class="p-3" :xs="24" :sm="24" :md="24" :lg="8" :xl="8">
          <ProfitBreakdown />
        </el-col>
      </el-row>
      <el-row>
        <!-- ç¬¬äºŒè¡Œï¼šæŠ•èµ„ç»„åˆå’Œèµ°åŠ¿é¢„æµ‹ -->
        <el-col class="p-3" :xs="24" :sm="24" :md="24" :lg="16" :xl="16">
          <InvestmentPortfolio />
        </el-col>
        <el-col class="p-3" :xs="24" :sm="24" :md="24" :lg="8" :xl="8">
          <TrendPrediction />
        </el-col>
      </el-row>
    </el-main>
  </el-container>
  <!-- å³ä¾§è¾¹æ  -->
  <UserSidebar />
</template>

<script setup lang="ts">
import CurrencyList from '@/components/common/CurrencyList.vue'
import { onMounted } from 'vue'
import PerformanceChart from '@/components/charts/PerformanceChart.vue'
import ProfitBreakdown from '@/components/common/ProfitBreakdown.vue'
import InvestmentPortfolio from '@/components/common/InvestmentPortfolio.vue'
import TrendPrediction from '@/components/charts/TrendPrediction.vue'
import UserSidebar from '@/components/layout/UserSidebar.vue'
import HeaderFirstRow from '@/components/layout/HeaderFirstRow.vue'
import { useGlobalUserInfo } from '@/stores/globalUserStore'
import { useUserInfo } from '@/composables/useUserInfo'

// ä½¿ç”¨å…¨å±€ç”¨æˆ·çŠ¶æ€
const { 
  userInfo, 
  isLoading, 
  errorMessage, 
  greeting, 
  userInitial, 
  fetchUserInfo 
} = useGlobalUserInfo()

// ä¿ç•™åŸæ¥çš„å…¶ä»–å‡½æ•°
const { getKycStatusText, handleEditButtonClick } = useUserInfo()

// ç»„ä»¶æŒ‚è½½æ—¶è·å–ç”¨æˆ·ä¿¡æ¯
onMounted(() => {
  console.log('ğŸ¯ DashboardContent onMounted è¢«è°ƒç”¨')
  console.log('ğŸ“ å‡†å¤‡è°ƒç”¨ fetchUserInfo')
  fetchUserInfo()
  console.log('ğŸ“ fetchUserInfo è°ƒç”¨å®Œæˆ')
})
</script>

<style scoped lang="scss">
@use './dashboard-content.scss';
</style>
